<div id="fade" class="popupOverlay"></div>
<div class="admin-panel clearfix">
    <div class="slidebar">
        <div class="logo">
            <a href="/"></a>
        </div>
        <ul>
            <li class="drop">
                <a href="#dashboard" class="dropTitle"><i class="fa fa-folder-o static" aria-hidden="true"></i>
                    Physiology<i class="fa fa-angle-up dynamic"></i>
                </a>
                <ul class="subMenu active">
                    <li>
                      <a href="#dashboard" id="targeted" class="sidebar-link">
                        <i class="fa fa-picture-o static" aria-hidden="true"></i>
                        Reaction Diagram
                      </a>
                    </li>
                    <li>
                      <a href="#reactions" class="sidebar-link">
                        <i class="fa fa-flask static" aria-hidden="true"></i>
                        Reactions
                      </a>
                    </li>
                    <li>
                      <a href="#structures" class="sidebar-link">
                        <i class="fa fa-codepen static" aria-hidden="true"></i>
                        Structures
                      </a>
                    </li>
                    <li>
                      <a href="#species" class="sidebar-link">
                        <i class="fa fa-link static" aria-hidden="true"></i>
                        Species
                      </a>
                    </li>
                    <li>
                      <a href="#molecules" class="sidebar-link">
                        <i class="fa fa-empire static" aria-hidden="true"></i>
                        Molecules
                      </a>
                    </li>
                    <li>
                      <a href="#observables" class="sidebar-link">
                        <i class="fa fa-eercast static" aria-hidden="true"></i>
                        Observables
                      </a>
                    </li>
                </ul>
            </li>
            <li class="drop">
                <a href="#applications" class="dropTitle">
                  <i class="fa fa-folder-o static" aria-hidden="true"></i>
                  Applications
                  <i class="fa fa-angle-down dynamic"></i>
                </a>
                <ul class="subMenu">
                    {{#each data.vcml.BioModel}}
                    {{#each this.SimulationSpec as |value key|}}
                    <li class="drop child">
                        <a href="#specsSpecies{{key}}" class="dropTitle">
                          <i class="fa fa-folder-o static" aria-hidden="true"></i>
                          <span class="wordLimit">{{value.$.Name}}</span>
                          <i class="fa fa-angle-down dynamic"></i>
                        </a>
                        <ul class="subMenu">
                            <li>
                              <a href="#specsSpecies{{key}}" class="">
                                <i class="fa fa-pencil-square-o static" aria-hidden="true"></i>
                                Specs - Species
                              </a>
                            </li>
                            <li>
                              <a href="#specsReaction{{key}}" class="">
                                <i class="fa fa-pencil-square-o static" aria-hidden="true"></i>
                                Specs - Reactions
                              </a>
                            </li>
                            <li>
                              <a href="#assignments{{key}}" class="">
                                <i class="fa fa-superpowers static" aria-hidden="true"></i>
                                Assignment Rules
                              </a>
                            </li>
                            <li>
                              <a href="#events{{key}}" class="">
                                <i class="fa fa-superpowers static" aria-hidden="true"></i>
                                Events
                              </a>
                            </li>
                            <li>
                              <a href="#raterules{{key}}" class="">
                                <i class="fa fa-superpowers static" aria-hidden="true"></i>
                                Rate Rules
                              </a>
                            </li>
                            <li>
                              <a href="#geometry{{key}}" class="">
                                <i class="fa fa-superpowers static" aria-hidden="true"></i>
                                Geometry
                              </a>
                            </li>
                            <li>
                              <a href="#simulations{{key}}" class="">
                                <i class="fa fa-superpowers static" aria-hidden="true"></i>
                                Simulations
                              </a>
                            </li>
                        </ul>
                    </li>
                    {{/each}}
                    {{/each}}
                </ul>
            </li>
            <li class="drop">
                <a href="#global" class="dropTitle sidebar-link">
                  <i class="fa fa-globe static" aria-hidden="true"></i>
                    Global Parameters
                </a>
            </li>
            <li class="drop">
                <a href="#downloads" class="dropTitle sidebar-link">
                  <i class="fa fa-globe static" aria-hidden="true"></i>
                    Downloads
                </a>
            </li>
        </ul>
    </div>

    <div class="main">
        <ul class="topbar clearfix">
            {{#each data.vcml.BioModel}}
            {{#each this.Version}}
            <li>
              <p id="modelName" href="#dashboard">
                {{~trimString this.$.Name}}
              </p>
            </li>
            <li class="printable">
              <a id="print-link" href="/curatedList/printModel/{{this.$.KeyValue}}">
                <i class="fa fa-print" aria-hidden="true"></i>
              </a>
            </li>

            {{!-- var define for downloads section. used in main.js file. --}}
            <li style="display: none"><a id="selectedModel">{{this.$.Name}}</a></li>

            {{/each}}
            {{/each}}
        </ul>
        <!-- <div class="landingContent">
          <h2>Landing content</h2>
        </div> -->
        <div class="mainContent clearfix">
            <div id="physiology" class="optionData">
                <h2 class="header">Physiology</h2>

            </div>

            {{!-- Reaction Diagram  --}}
            <div id="dashboard" class="optionData">
                <h2 class="header"><span class="icon"></span>Reaction Diagram</h2>
                <div class="reactionDiagram" id="diagram">
                    {{#each data.vcml.BioModel}}
                    {{#each this.Version}}
                    <img class="model-page-diagram" src="https://vcellapi-beta.cam.uchc.edu:8080/biomodel/{{this.$.KeyValue}}/diagram"
                        alt="reactionDiagram" draggable="false" />
                    {{/each}}
                    {{/each}}

                </div>

                {{!--info Reaction Diagram--}}

                <div class="box-diagram">
                    <div class='textWrap'>
                        <div class="publications" id="globalPublications" onclick="test(BioModel)">
                            <h2>Cross-References</h2>

                        </div>
                        <div class="annotations" id="globalAnnotations">
                            <h2>Annotations</h2>
                        </div>
                    </div>
                </div>

                {{!-- popup --}}
            </div>

            {{!-- Reactions Table  --}}
            <div id="reactions" class="optionData">
                <h2 class="header">Reactions</h2>
                <div class="modelTable">
                    <table id="content-table3-reactions" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Reactions">Reactions
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Reactions', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Reactions', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Structure">Structure
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Structure', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Structure', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Kinetics">Kinetics
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Kinetics', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Kinetics', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Kinetics">Depiction
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Kinetics', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Kinetics', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each data.vcml.BioModel}}
                            {{#each this.Model}}
                            {{#each this.SimpleReaction as |value key|}}
                            <tr>
                                <td data-label="Reactions" class="Reactions" id="{{value.$.Name}}" onClick="reply_click(this.id)" style="cursor: pointer">
                                    {{~#each value.Reactant}}
                                    {{~nullCheck this.$.LocalizedCompoundRef}}
                                    {{~#if (greater ../this.Reactant.length (add 1 @index))~}}
                                    +
                                    {{~/if}}
                                    {{~/each~}}
                                    <span><i class="fa fa-long-arrow-right" aria-hidden="true"></i></span>
                                    {{~#each value.Product}}
                                    {{~this.$.LocalizedCompoundRef}}
                                    {{~#if (greater ../this.Product.length (add 1 @index))~}}
                                    +
                                    {{~/if}}
                                    {{~/each~}}
                                </td>
                                <td id="{{value.$.Name}}" onClick="reply_click(this.id)" style="cursor: pointer" data-label="Name" class="Name">
                                  <a id="{{value.$.Name}}" onClick="reply_click(this.id)" style="cursor:pointer; color:#3EB9FE">
                                    {{value.$.Name}}
                                  </a>
                                </td>
                                <td id="{{value.$.Name}}" onClick="reply_click(this.id)" style="cursor: pointer" data-label="Structure" class="Structure">{{value.$.Structure}}</td>
                                {{#each value.Kinetics}}
                                <td data-label="Kinetics" class="Kinetics" id="{{key}}" onClick="reply_click(this.id)" style="cursor:pointer;">
                                  <a id="{{key}}" onClick="reply_click(this.id)" style="cursor:pointer; color:#3EB9FE">
                                    {{this.$.KineticsType}}
                                  </a>
                                </td>
                                {{/each}}
                                <td id="{{value.$.Name}}" onClick="reply_click(this.id)" style="cursor: pointer">
                                  <canvas id="{{this.$.Name}}_species_canvas" class="molecule_canvas" width="" height=""></canvas>
                                </td>
                            </tr>

                            {{/each}}
                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
                {{!-- popup reactions --}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.SimpleReaction as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text'>


                        {{!-- universal ID's  --}}
                        <div class="uid" id="reactionUID-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="reactionTA-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>


                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}
                {{!-- popup reactions Expressions--}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.SimpleReaction as |value key|}}
                {{#each value.Kinetics}}
                <div class="popup box-{{key}}">
                    <div class='popup-text block'>
                        {{!-- Expressions --}}
                        <h2 id="reactionNameExp">Expressions for {{value.$.Name}}</h2>

                        {{!-- Local Parameters --}}
                        {{#each this.Parameter}}
                        <div class="role">
                            <p class="role-title">
                              {{#if (eq this.$.Role "user defined")}}
                              local
                              {{else}}
                              {{this.$.Role}}
                              {{/if}}
                            </p>
                            <p class="role-variable">{{this.$.Name}}</p>
                            <p class="role-text">{{this._}} <span class="unit">[{{this.$.Unit}}]</span> </p>
                        </div>

                        {{!-- Global Parameters --}}
                        {{#each ../../../this.ModelParameters.[0].Parameter}}
                        {{#if (includes ../this._ this.$.Name)}}
                        <div class="role">
                            <p class="role-title">
                              global
                            </p>
                            <p class="role-variable">{{this.$.Name}}</p>
                            <p class="role-text">{{this._}} <span class="unit">[{{this.$.Unit}}]</span></p>
                        </div>
                        {{/if}}
                        {{/each}}
                        {{/each}}

                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}
            </div>

            {{!-- Structures Table  --}}
            <div id="structures" class="optionData">
                <h2 class="header">Structures</h2>
                <div class="modelTable">
                    <table id="content-table3-structures" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Type">Type
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Type', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Type', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Electrical">Electrical
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Electrical', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Electrical', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each data.vcml.BioModel}}
                            {{#each this.Model}}
                            {{#each this.Membrane}}
                            <tr id={{this.$.Name}} onClick="reply_click(this.id)" style="cursor: pointer;">
                                <td data-label="Name" class="Name">
                                  <a id={{this.$.Name}} onClick="reply_click(this.id)" style="cursor:pointer; color:#3EB9FE">
                                    {{this.$.Name}}
                                  </a>
                                </td>
                                <td data-label="Type" class="Type">Membrane</td>
                                <td data-label="Electrical" class="Electrical">
                                    {{this.$.PositiveFeature}}(+) &nbsp; {{this.$.NegativeFeature}}(-)
                                </td>
                            </tr>

                            {{/each}}
                            {{#each this.Feature}}
                            <tr id={{this.$.Name}} onClick="reply_click(this.id)" style="cursor:pointer;">
                                <td data-label="Name" class="Name">
                                  <a id={{this.$.Name}} onClick="reply_click(this.id)" style="cursor:pointer; color:#3EB9FE">
                                    {{this.$.Name}}
                                  </a>
                                </td>
                                <td data-label="Type" class="Type">Compartment</td>
                                <td data-label="Electrical" class="Electrical">
                                    {{this.$.PositiveFeature}}(+) &nbsp; {{this.$.NegativeFeature}}(-)
                            </tr>
                            {{/each}}
                            {{/each}}
                            {{/each}}


                        </tbody>
                    </table>
                </div>

                {{!-- popup structures membrane--}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.Membrane as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text'>

                        {{!-- universal ID's  --}}
                        <div class="uid" id="structureUID-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="structureTA-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>

                    </div>
                    <a class='popup-close' href="#structures"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}

                {{!-- popup structures features --}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.Feature as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text'>
                        <!---removed: to save space <h3>Structure Name: <span>{{value.$.Name}}</span></h3>--->
                        {{!-- universal ID's  --}}
                        <div class="uid" id="structureUID-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="structureTA-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>
                    </div>
                    <a class='popup-close' href="#structures"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}
            </div>

            {{!-- Species table  --}}
            <div id="species" class="optionData">
                <h2 class="header">Species</h2>
                <div class="modelTable">
                    <table id="content-table3-species" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3-species');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3-species');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Structure">Structure
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Structure', 'content-table3-species');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Structure', 'content-table3-species');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Structure">BioNetGen Definition
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Structure', 'content-table3-species');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Structure', 'content-table3-species');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Structure">Depiction
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Structure', 'content-table3-species');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Structure', 'content-table3-species');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each data.vcml.BioModel}}
                            {{#each this.Model}}
                            {{#each this.LocalizedCompound}}
                            <tr id={{this.$.Name}} onClick="reply_click(this.id)" style="cursor:pointer;">
                                <td data-label="Name" class="Name">
                                  <a id={{this.$.Name}} onClick="reply_click(this.id)" style="cursor:pointer; color:#3EB9FE">
                                    {{this.$.Name}}
                                  </a>
                                </td>
                                <td data-label="Structure" class="Structure">{{this.$.Structure}}</td>
                                <td data-label="bionetgen" class="bionetgen">
                                  {{~#each this.SpeciesPattern~}}
                                  {{#each this.MolecularTypePattern~}}
                                  {{#each this.MolecularType~}}
                                  {{this.$.Name~}}(
                                  {{~/each~}}
                                  {{#each this.ComponentPattern~}}
                                  {{this.$.MolecularComponent~}}
                                  {{#this.$.ComponentStatePattern~}}~
                                  {{~this~}}
                                  {{/this.$.ComponentStatePattern~}}!
                                  {{~this.$.BondType~}},
                                  {{~/each~}}).
                                  {{~/each~}}
                                  {{/each}}</td>
                                <td data-label="depiction" class="depiction">
                                  {{!-- dimensions of this canvas are variable --}}
                                  <canvas id="{{this.$.Name}}_species_canvas" class="molecule_canvas">
                                    {{~this.$.Structure~}}
                                  </canvas>
                                </td>
                            </tr>
                            {{/each}}
                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
                {{!-- popup Species --}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.LocalizedCompound as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text'>
                        {{!-- universal ID's  --}}
                        <div class="uid" id="speciesUID-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="speciesTA-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>

                    </div>
                    <a class='popup-close' href="#species"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}
            </div>

            {{!-- Molecules table  --}}
            <div id="molecules" class="optionData">
                <h2 class="header">Molecules</h2>
                <div class="modelTable">
                    <table id="content-table3-molecules" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Description">BioNetGen Definition
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Description', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Description', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Description">DEPICTION
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Description', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Description', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each data.vcml.BioModel}}
                            {{#each this.Model}}
                            {{#each this.RbmModelContainer}}
                            {{#each this.MolecularTypeList}}
                            {{#each this.MolecularType}}

                            <tr id={{this.$.Name}} onClick="reply_click(this.id)" style="cursor:pointer;">
                                <td data-label="Name" class="Name">
                                  <a id={{this.$.Name}} onClick="reply_click(this.id)" style="cursor:pointer; color:#3EB9FE">
                                    {{this.$.Name}}
                                  </a>
                                </td>

                                <td data-label="Description" class="Description">
                                  {{~this.$.Name}}(
                                  {{~#each this.MolecularComponent~}}
                                  {{this.$.Name~}}
                                  {{#each AllowableState}}~
                                  {{~this.$.Name~}}
                                  {{/each~}},
                                  {{~/each}})</td>
                                <td data-label="Depiction" class="Depiction">
                                  <canvas id="{{this.$.Name}}_molecules_canvas" class="molecule_canvas" width="" height=""></canvas>
                                </td>
                            </tr>
                            {{/each}}{{/each}}{{/each}}{{/each}}{{/each}}
                        </tbody>
                    </table>
                </div>
                {{!-- popup Molucules --}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.RbmModelContainer}}
                {{#each this.MolecularTypeList}}
                {{#each this.MolecularType as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text'>

                        {{!-- universal ID's  --}}
                        <div class="uid" id="moleculesUID-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="moleculeTA-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>

                    </div>
                    <a class='popup-close' href="#molecules"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                    {{#each this.annotations}}
                    <script>
                    /*
                    //old method for adding annotations
                    try {
                      var element = document.getElementById('moleculeTA-{{this.label}}');
                      var node = document.createTextNode("{{this.freetext}}");
                      element.appendChild(node);
                    } catch {}*/
                    </script>
                    {{/each}}
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}
            </div>

            {{!-- Observables table  --}}
            <div id="observables" class="optionData">
                <h2 class="header">Observables</h2>
                <div class="modelTable">
                    <table id="content-table3-observables" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Structure">Structure
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Structure', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Structure', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Domain">Count
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Domain', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Domain', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="MolecularType">BNGL Definition
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'MolecularType', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'MolecularType', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="SequenceType">Sequence Type
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'SequenceType', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'SequenceType', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Depiction">DEPICTION
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'SequenceType', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'SequenceType', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>

                            </tr>
                        </thead>
                        <tbody>
                            {{#each data.vcml.BioModel}}
                            {{#each this.Model}}
                            {{#each this.RbmModelContainer}}
                            {{#each this.RbmObservableList}}
                            {{#each this.Observable}}

                            <tr id={{this.$.Name}} onClick="reply_click(this.id)" style="cursor:pointer;">
                                <td data-label="Name" class="Name">
                                  <a id={{this.$.Name}} onClick="reply_click(this.id)" style="cursor:pointer; color:#3EB9FE">
                                    {{this.$.Name}}
                                  </a>
                                </td>
                                <td data-label="Structure" class="Structure">{{this.$.Structure}}</td>
                                <td data-label="Domain" class="Domain">{{this.$.ObservableType}}</td>
                                {{#each this.SpeciesPattern}}
                                {{#each this.MolecularTypePattern}}
                                <td data-label="MolecularType" class="MolecularType">
                                  {{~#each this.MolecularType~}}
                                  {{this.$.Name~}}(
                                  {{~/each~}}
                                  {{#each this.ComponentPattern~}}
                                  {{this.$.MolecularComponent~}}
                                  {{#this.$.ComponentStatePattern~}}~
                                  {{~this~}}
                                  {{/this.$.ComponentStatePattern~}}!
                                  {{~this.$.BondType~}},
                                  {{~/each~}}).
                                  {{~null~}}
                                </td>
                                {{/each}}
                                {{/each}}
                                <td data-label="SequenceType" class="SequenceType">{{this.$.Sequence}}</td>

                                <td>
                                  <canvas id="{{this.$.Name}}_observables_canvas" class="molecule_canvas" width="" height=""></canvas>
                                </td>

                            </tr>

                            {{/each}}
                            {{/each}}
                            {{/each}}
                            {{/each}}
                            {{/each}}

                        </tbody>
                    </table>
                </div>

                {{!-- popup Observables --}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.RbmModelContainer}}
                {{#each this.RbmObservableList}}
                {{#each this.Observable as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text'>

                        {{!-- universal ID's  --}}
                        <div class="uid" id="observableUID-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="observableTA-{{value.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>

                    </div>
                    <a class='popup-close' href="#observables"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}
                {{/each}}
                {{/each}}
                {{/each}}
                {{!-- popup --}}
            </div>

            {{!-- Applications Table  --}}
            <div id="applications" class="optionData">
                <h2 class="header">Applications</h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="properties">Properties
                                </th>
                                <th class="Type">Math Type
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Type', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Type', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>

                            {{#each data.vcml.BioModel}}
                            {{#each this.SimulationSpec as |value key|}}
                            <tr>
                                <td id={{this.$.Name}} onClick="reply_click(this.id)" style="cursor:pointer;" data-label="Name" class="Name">
                                  <a id={{this.$.Name}} onClick="reply_click(this.id)" style="cursor:pointer; color:#3EB9FE">
                                    {{this.$.Name}}
                                  </a>
                                </td>
                                <td data-label="properties" class="properties">
                                    <a href="#specsSpecies{{key}}" style="cursor:pointer; color:#3EB9FE">Specs -
                                        Species</a> <br>
                                    <a href="#specsReaction{{key}}" style="cursor:pointer; color:#3EB9FE">Specs -
                                        Reaction</a> <br>
                                    <a href="#simulations{{key}}" style="cursor:pointer; color:#3EB9FE">Simulations</a>
                                </td>
                                <td id={{this.$.Name}} onClick="reply_click(this.id)" style="cursor:pointer;" data-label="Type" class="Type" id="mathType">
                                  {{#if (eq "true" this.$.Stochastic)}}
                                    {{#if (eq "true" this.$.RuleBased)}}
                                    Stochastic agent-based (NFSim)
                                    {{else}}
                                    Stochastic (SSA)
                                    {{/if}}
                                  {{else}}
                                    {{#if (eq "true" this.$.RuleBased)}}
                                    Deterministic rule-based (BioNetGen)
                                    {{else}}
                                    Deterministic (ODE)
                                    {{/if}}
                                  {{/if}}
                                  {{#each this.Geometry}}
                                    {{#if (eq "0" this.$.Dimension)}}
                                    Compartmental
                                    {{/if}}
                                    {{#if (eq "2" this.$.Dimension)}}
                                    Spatial (2D)
                                    {{/if}}
                                    {{#if (eq "3" this.$.Dimension)}}
                                    Spatial (3D)
                                    {{/if}}
                                  {{/each}}
                                </td>
                            </tr>

                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
                {{!-- popup applications --}}
                {{#each data.vcml.BioModel}}
                {{#each this.SimulationSpec as |value key|}}
                <div class="popup box-{{value.$.Name}}">
                    <div class='popup-text'>
                      <div class="uid" id="applicationUID-{{value.$.Name}}">
                          <h2>{{value.$.Name}} Universal ID's</h2>
                      </div>
                      {{!-- annotation --}}
                      <div class="textAnnotation" id="applicationTA-{{value.$.Name}}">
                          <h2>{{value.$.Name}} Text Annotations</h2>
                      </div>
                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>
                {{/each}}
                {{/each}}

                {{!-- popup --}}
            </div>

            {{!-- for each application  --}}
            {{#each data.vcml.BioModel}}
            {{#each this.SimulationSpec as |value key|}}
            {{!-- specifications - Species table  --}}
            <div id="specsSpecies{{key}}" class="optionData">
                <h2 class="header">Specifications (Species) - {{value.$.Name}} <span class="propertyBtn"><a
                            href="#simulations{{key}}">go to
                            Simulations</a></span> </h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Species">Species
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Species', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Species', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>

                                <th class="Initial">Initial Condition
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Initial', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Initial', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Diffusion">Diffusion Constant
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Diffusion', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Diffusion', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each this.ReactionContext}}
                            {{#each this.LocalizedCompoundSpec}}
                            <tr>
                                <td data-label="Species" class="Species">
                                  {{this.$.LocalizedCompoundRef}}
                                </td>
                                <td data-label="Initial" class="Initial">
                                  {{this.InitialConcentration}}
                                </td>
                                <td data-label="Diffusion" class="Diffusion">
                                  {{~this.Diffusion~}}
                                  <span class="unit">
                                    [{{../../../this.Model.[0].ModelUnitSystem.[0].$.AreaUnit~}}
                                    /{{../../../this.Model.[0].ModelUnitSystem.[0].$.TimeUnit}}]
                                  </span>
                                </td>
                            </tr>
                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>
            {{!-- specifications - Reaction table  --}}
            <div id="specsReaction{{key}}" class="optionData">
                <h2 class="header">Specifications (Reaction) - {{value.$.Name}} <span class="propertyBtn"><a
                            href="#simulations{{key}}">go to
                            Simulations</a></span> </h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>

                                <th class="ReactionMapping">Enabled?
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'ReactionMapping', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'ReactionMapping', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>

                            {{#each value.ReactionContext}}
                            {{#each this.ReactionSpec}}
                            <tr>
                                <td data-label="Name" class="Name">{{this.$.ReactionStepRef}}</td>
                                <td data-label="ReactionMapping" class="ReactionMapping">{{this.$.ReactionMapping}}</td>
                            </tr>

                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>

            {{!-- simulations table  --}}
            <div id="simulations{{key}}" class="optionData">
                <h2 class="header">Simulations - {{value.$.Name}} <span class="propertyBtn"><a
                            href="#specifications{{key}}">go to
                            Specifications</a></span></h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="endTime">End Time
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'endTime', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'endTime', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Output">Output Options
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Output', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Output', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each value.Simulation}}
                            <tr id={{this.$.Name}}
                              onClick="reply_click(this.id)"
                              style="cursor:pointer;">
                                <td data-label="Name" class="Name">
                                  <a id={{this.$.Name}}
                                    onClick="reply_click(this.id)"
                                    style="cursor:pointer; color:#3EB9FE">
                                    {{this.$.Name}}
                                  </a>
                                </td>
                                {{#each this.SolverTaskDescription}}
                                {{#each this.TimeBound}}
                                <td data-label="endTime" class="endTime">
                                  {{ this.$.EndTime}}
                                </td>
                                {{/each}}
                                <td data-label="Output" class="Output">
                                  {{#each ../../../../outputOptions}}
                                  <p>{{this.key}} {{this.val}}</p>
                                  {{/each}}
                                </td>
                                {{/each}}
                            </tr>
                            {{/each}}
                        </tbody>
                    </table>
                </div>
                {{!-- popup Simulations --}}
                {{#each value.Simulation}}
                <div class="popup box-{{this.$.Name}}">
                    <div class='popup-text'>
                        {{!-- universal ID's  --}}
                        <div class="uid" id="UID-{{this.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="TA-{{this.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>

                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>

                {{/each}}
                {{!-- popup --}}
            </div>

            {{!-- Assignment Rules Table --}}
            <div id="assignments{{key}}" class="optionData">
                <h2 class="header">Assignments</h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Variable</th>
                                <th>Assignment Function Expression</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each this.AssignmentRules}}
                            {{#each this.AssignmentRule}}
                            <tr>
                                <td>{{this.$.Name}}</td>
                                <td>{{this.$.AssignmentRuleVariable}}</td>
                                <td>{{this._}}</td>
                            </tr>
                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>

            {{!-- Events Table --}}
            <div id="events{{key}}" class="optionData">
                <h2 class="header">Events</h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Trigger Type</th>
                                <th>Variable Assignment</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each this.BioEvents}}
                            {{#each this.BioEvent}}
                            <tr>
                                <td>{{this.$.Name}}</td>
                                <td>
                                  {{convertTrigger this}}
                                </td>
                                <td>
                                  {{~#each EventAssignment~}}
                                  {{this.$.Variable}} --> {{this._~}}
                                  {{#if (greater ../this.EventAssignment.length (add 1 @index))~}}
                                  ,
                                  {{/if~}}
                                  {{/each~}}
                                </td>
                            </tr>
                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>

            {{!-- Geometry Table --}}
            <div id="geometry{{key}}" class="optionData">
                <h2 class="header">Geometry</h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Trigger Type</th>
                                <th>Variable Assignment</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each this.BioEvents}}
                            {{#each this.BioEvent}}
                            <tr>
                                <td>{{this.$.Name}}</td>
                                <td>
                                  {{convertTrigger this}}
                                </td>
                                <td>
                                  {{~#each EventAssignment~}}
                                  {{this.$.Variable}} --> {{this._~}}
                                  {{#if (greater ../this.EventAssignment.length (add 1 @index))~}}
                                  ,
                                  {{/if~}}
                                  {{/each~}}
                                </td>
                            </tr>
                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>

            {{!-- Rate Rules Table --}}
            <div id="raterules{{key}}" class="optionData">
                <h2 class="header">Events</h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Variable</th>
                                <th>Rate Expression</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each this.RateRules}}
                            {{#each this.RateRule}}
                            <tr>
                                <td>{{this.$.Name}}</td>
                                <td>{{this.$.RateRuleVariable}}</td>
                                <td>{{this._}}</td>
                            </tr>
                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
            </div>
            {{/each}}
            {{/each}}


            {{!-- Gloabal Parameters Table --}}
            <div id="global" class="optionData">
                <h2 class="header">Global Parameters</h2>
                <div class="modelTable">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th class="Name globalParameterName">Name
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Name', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Name', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="Expression">Expression
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Expression', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Expression', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#each data.vcml.BioModel}}
                            {{#each this.Model}}
                            {{#each this.ModelParameters}}
                            {{#each this.Parameter}}
                            <tr>
                                <td data-label="Name" class="Name"><a id={{this.$.Name}} onClick="reply_click(this.id)"
                                        style="cursor:pointer; color:#3EB9FE">{{this.$.Name}}</a></td>
                                <td data-label="Expression" class="Expression">
                                  {{this._}}<span class="unit">[{{this.$.Unit}}]</span>
                                </td>
                            </tr>
                            {{/each}}
                            {{/each}}
                            {{/each}}
                            {{/each}}
                        </tbody>
                    </table>
                </div>
                {{!-- popup parameters --}}
                {{#each data.vcml.BioModel}}
                {{#each this.Model}}
                {{#each this.ModelParameters}}
                {{#each this.Parameter}}
                <div class="popup box-{{this.$.Name}}">
                    <div class='popup-text'>

                        {{!-- universal ID's  --}}
                        <div class="uid" id="parameterUID-{{this.$.Name}}">
                            <h2>{{value.$.Name}} Universal ID's</h2>
                        </div>
                        {{!-- annotation --}}
                        <div class="textAnnotation" id="parameterTA-{{this.$.Name}}">
                            <h2>{{value.$.Name}} Text Annotations</h2>
                        </div>

                    </div>
                    <a class='popup-close' href="#reactions"><i class="fa fa-window-close" aria-hidden="true"></i></a>
                </div>

                {{/each}}
                {{/each}}
                {{/each}}
                {{/each}}

                {{!-- popup --}}
            </div>

            {{!-- Downloads --}}
            {{#each data.vcml.BioModel}}
            <div id="downloads" class="optionData">
                <h2 class="header">Downloads</h2>
                <div class="modelTable noBoundries">
                    <table id="content-table3" class="table-responsive-full sort-table">
                        <thead>
                            <tr>
                                <th>Model Format
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Format', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Format', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th>Model Downloads</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Virtual Cell Markup Language</td>
                                <td data-label="File" class="File">
                                  <a href="https://vcellapi-beta.cam.uchc.edu:8080/biomodel/{{this.Version.[0].$.KeyValue}}/biomodel.vcml">
                                    VCML File
                                  </a>
                                </td>
                            </tr>
                            <tr>
                                <td>PDF Report</td>
                                <td data-label="File" class="File">
                                  <a href="https://vcellapi-beta.cam.uchc.edu:8080/biomodel/{{this.Version.[0].$.KeyValue}}/biomodel.pdf">
                                    Report
                                  </a>
                                </td>
                            </tr>
                            <tr>
                                <td>COMBINE Archive</td>
                                <td data-label="File" class="File">
                                  <a href=
                                    "https://vcellapi-beta.cam.uchc.edu:8080/biomodel/
                                    {{~this.Version.[0].$.KeyValue~}}
                                    /biomodel.omex?appname={{convertSpace this.SimulationSpec.[0].$.Name}}"
                                  >
                                  OMEX File
                                  </a>
                                </td>
                            </tr>
                            <tr>
                                <td>SEDML</td>
                                <td data-label="File" class="File">
                                  <a href=
                                    "https://vcellapi-beta.cam.uchc.edu:8080/biomodel/
                                    {{~this.Version.[0].$.KeyValue~}}
                                    /biomodel.sedml?appname={{convertSpace this.SimulationSpec.[0].$.Name}}"
                                  >
                                  SEDML File
                                  </a>
                                </td>
                            </tr>
                        </tbody>
                        <thead>
                            <tr>
                                <th class="Format">File Format
                                    <div class="sort-table-arrows">
                                        <a href="javascript:sort(true, 'Format', 'content-table3');"><button
                                                class="button" title="down arrow"><i
                                                    class="fa fa-chevron-down"></i></button></a>
                                        <a href="javascript:sort(false, 'Format', 'content-table3');"><button
                                                class="button" title="up arrow"><i
                                                    class="fa fa-chevron-up"></i></button></a>
                                    </div>
                                </th>
                                <th class="File">Application Downloads</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr id="bngl">
                                <td data-label="Format" class="Format">BNGL</td>
                                <td data-label="File" class="File">
                                  {{#each SimulationSpec}}
                                  <a href=
                                    "https://vcellapi-beta.cam.uchc.edu:8080/biomodel/
                                    {{~../this.Version.[0].$.KeyValue~}}
                                    /biomodel.bngl?appname={{convertSpace this.$.Name}}"
                                  >
                                  {{this.$.Name}}.bngl
                                  </a>
                                  {{~#if (greater ../this.SimulationSpec.length (add 1 @key))~}}
                                  ,
                                  {{~/if}}
                                  {{~/each~}}
                                </td>
                            </tr>
                            <tr id="sbml">
                                <td data-label="Format" class="Format">SBML</td>
                                <td data-label="File" class="File">
                                  {{#each SimulationSpec}}
                                  <a href=
                                    "https://vcellapi-beta.cam.uchc.edu:8080/biomodel/
                                    {{~../this.Version.[0].$.KeyValue~}}
                                    /biomodel.sbml?appname={{convertSpace this.$.Name}}"
                                  >
                                  {{this.$.Name}}.sbml
                                  </a>
                                  {{~#if (greater ../this.SimulationSpec.length (add 1 @key))~}}
                                  ,
                                  {{~/if}}
                                  {{/each}}
                                </td>
                            </tr>
                            <tr id="matlab">
                                <td data-label="Format" class="Format">Matlab</td>
                                <td data-label="File" class="File">
                                  {{#each SimulationSpec}}
                                  <a href=
                                    "https://vcellapi-beta.cam.uchc.edu:8080/biomodel/
                                    {{~../this.Version.[0].$.KeyValue~}}
                                    /biomodel.m?appname={{convertSpace this.$.Name}}"
                                  >
                                  {{this.$.Name}}.m
                                  </a>
                                  {{~#if (greater ../this.SimulationSpec.length (add 1 @key))~}}
                                  ,
                                  {{~/if}}
                                  {{/each}}
                                </td>
                            </tr>
                            <tr id="xml">
                                <td data-label="Format" class="Format">NFSim XML</td>
                                <td data-label="File" class="File">
                                  {{#each SimulationSpec}}
                                  <a href=
                                    "https://vcellapi-beta.cam.uchc.edu:8080/biomodel/
                                    {{~../this.Version.[0].$.KeyValue~}}
                                    /biomodel.xml?appname={{convertSpace this.$.Name}}"
                                  >
                                  {{this.$.Name}}.xml
                                  </a>
                                  {{~#if (greater ../this.SimulationSpec.length (add 1 @key))~}}
                                  ,
                                  {{~/if}}
                                  {{/each}}
                                </td>
                                {{/each}}
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


<script src="/js/model-graphics.js"></script>

<script src="/js/main.js"></script>

<script>
    //draw graphics
    //species
    drawGraphics('content-table3-species', 2, 3, 'g');
    //molecules
    drawGraphics('content-table3-molecules', 1, 2, 'm');
    //observables
    drawGraphics('content-table3-observables', 3, 5, 'g');

    //displaying electrical for only membrane compartments
    var table = document.getElementById('content-table3-structures');
    var cells = table.rows.item(1).cells;
    if (cells.item(1).innerHTML != 'Membrane'){
      cells.item(2).innerHTML = 'N/A';
    }

    //species initial conditions
    function removeItemAll(arr, value) {
      let i = 0;
      while (i < arr.length) {
        if (arr[i] === value) {
          arr.splice(i, 1);
        } else {
          ++i;
        }
      }
      return arr;
    }
    {{#each data.vcml.BioModel}}
    {{#each this.Model}}
    {{#each this.ModelUnitSystem}}
    let MembraneSubstanceUnit = "{{this.$.MembraneSubstanceUnit}}";
    let VolumeSubstanceUnit = "{{this.$.VolumeSubstanceUnit}}";
    {{/each}}
    {{/each}}
    {{/each}}
    let speciesRows = document.getElementById("content-table3-species").rows;
    let structuresRows = document.getElementById("content-table3-structures").rows;
    let strucNameTypeMap = {};
    let nameBngMap = {};
    //add structure to name-type map
    for (let i = 1; i < structuresRows.length; i++) {
      let row = structuresRows.item(i).cells;
      let name = row.item(0).childNodes[0].innerHTML;
      let type = row.item(1).innerHTML;
      strucNameTypeMap[name] = type;
    }
    //set species initial conditions
    for (let i = 1; i < speciesRows.length; i++) {
      let row = speciesRows.item(i).cells;
      let name = row.item(0).childNodes[1].innerHTML.trim();
      let structure = row.item(1).innerHTML;
      let type = strucNameTypeMap[structure];
      let bng = row.item(2).innerHTML.trim();
      nameBngMap[name] = bng;
    }

    // making the first popup visible
    var firstPopup = document.querySelector(".popup").firstChild;
    firstPopup.parentElement.classList.add("firstPopup");

    //add reaction graphics
    //draw plus
    function drawPlus(x, totalHeight, canvas) {
      let plusLen = 30;
      let ctx = canvas.getContext('2d');
      ctx.beginPath();
      ctx.moveTo(x, totalHeight / 2);
      ctx.lineTo(x + plusLen, totalHeight / 2);
      ctx.moveTo(x + plusLen / 2, (plusLen + totalHeight) / 2);
      ctx.lineTo(x + plusLen / 2, (-plusLen + totalHeight) / 2);
      ctx.strokeStyle = "#000000";
      ctx.lineWidth = 2;
      ctx.stroke();
      ctx.closePath();
      ctx.lineWidth = 1;
    }

    //draw arrow
    function drawArrow(x, totalHeight, canvas) {
      let arrowLen = 30;
      let ctx = canvas.getContext('2d');
      ctx.beginPath();
      ctx.moveTo(x, totalHeight / 2);
      ctx.lineTo(x + arrowLen - 10, totalHeight / 2);
      ctx.moveTo(x + arrowLen, totalHeight / 2);
      ctx.lineTo(x + arrowLen / 2, totalHeight / 2 + 10);
      ctx.moveTo(x + arrowLen, totalHeight / 2);
      ctx.lineTo(x + arrowLen / 2, totalHeight / 2 - 10);
      ctx.strokeStyle = "#000000";
      ctx.lineWidth = 2;
      ctx.stroke();
      ctx.closePath();
      ctx.lineWidth = 1;
    }

    //get html elements
    let reactionRows = document.getElementById("content-table3-reactions").rows;
    let drawMap = {};
    let scale = 1;
    //iterate through rows
    for (let i = 1; i < reactionRows.length; i++) {
      let row = reactionRows.item(i).cells;
      let reaction = row.item(0).innerHTML;
      let canvas = row.item(4).childNodes[1];
      let firstSpanIndex = reaction.indexOf('<span>');
      let lastSpanIndex = reaction.indexOf('</span>');
      let reactants = reaction.slice(0, firstSpanIndex).split('+');
      let products = reaction.slice(lastSpanIndex + 7, reaction.length).split('+');
      reactants = removeItemAll(reactants, '');
      products = removeItemAll(products, '');
      let totalLength = 0;
      let totalHeight = 0;

      //create list of draw functions
      let drawList = [];

      //reactants
      for (let u = 0; u < reactants.length; u++) {
        //init obj
        let bng = nameBngMap[reactants[u]];
        let drawObj = new Graphic(bng, 'compact');

        //initial draw to get size
        var dims = drawObj.draw(canvas, totalLength, 0);
        totalLength += dims[0];

        //add draw function
        drawList.push(
          {
            func: (canvas, totalLength, totalHeight) => {
              drawObj.doDrawList();
            },
            x: totalLength
          }
        );

        //add plus if not last reactant
        if (u < reactants.length - 1) {
          drawList.push(
            {
              func: (canvas, totalLength, totalHeight) => {
                drawPlus(totalLength, totalHeight, canvas);
              },
              x: totalLength
            }
          );
          totalLength += 30;
        }

        //add height
        if (dims[1] > totalHeight) {
          totalHeight = dims[1];
        }
      }

      //add arrow between reactants, products
      drawList.push(
        {
          func: (canvas, totalLength, totalHeight) => {
            drawArrow(totalLength, totalHeight, canvas);
          },
          x: totalLength
        }
      );
      totalLength += 30;

      //products
      for (let u = 0; u < products.length; u++) {
        //init obj
        let bng = nameBngMap[products[u]];
        let drawObj = new Graphic(bng, 'compact');

        //initial draw to get size
        var dims = drawObj.draw(canvas, totalLength, 0, scale);
        totalLength += dims[0];

        //add draw function
        drawList.push(
          {
            func: (canvas, totalLength, totalHeight) => {
              drawObj.doDrawList();
            },
            x: totalLength
          }
        );

        //add plus if not last reactant
        if (u < products.length - 1) {
          drawList.push(
            {
              func: (canvas, totalLength, totalHeight) => {
                drawPlus(totalLength, totalHeight, canvas);
              },
              x: totalLength
            }
          );
          totalLength += 30;
        }

        //add height
        if (dims[1] > totalHeight) {
          totalHeight = dims[1];
        }
      }

      //resize canvas
      canvas.width = totalLength;
      canvas.height = totalHeight;

      //draw all elements
      for (let u = 0; u < drawList.length; u++) {
        let elm = drawList[u];
        elm.func(canvas, elm.x, totalHeight);
      }
    }



    // Open popup
    var open = 1;
    function reply_click(clicked_id) {
        if (open == 1) {
            $(".popup").css("opacity", 0);
            $(".overlay").css("opacity", 0);
            $(".popup").css("display", "none");
            $(".overlay").css("display", "none");
        }
        $(`[class="popup box-${clicked_id}"]`).css("opacity", 1);
        $(`[class="popup box-${clicked_id} firstPopup"]`).css("opacity", 1);
        $(".overlay").css("opacity", 0.8);
        $(`[class="popup box-${clicked_id}"]`).css("display", "block");
        $(`[class="popup box-${clicked_id} firstPopup"]`).css("display", "block");
        $(".overlay").css("display", "block");
        open = 1;
    };
    // close popup
    $(".popup-close").click(function () {
        open = 0;
        $(".popup").css("opacity", 0);
        $(".overlay").css("opacity", 0);
        setTimeout(function () {
            $(".popup").css("display", "none");
            $(".overlay").css("display", "none");
        }, 1000);
    });
    alerting = (variable) => {};

    //go to scroll given element in printable veiw
    const printLink = document.getElementById('print-link');

    function goToPrintable(e) {
      e.preventDefault();

      let url = window.location.href;
      let poundIndex = url.lastIndexOf('#');
      let elementID = url.slice(poundIndex, url.length);
      printLink.href += elementID;

      window.location.href = printLink.href;
    }

    printLink.addEventListener("click", (e) => {goToPrintable(e);});

    //ensure window is scrolled to top
    //initial fix
    setTimeout(() => {  window.scroll(0, 0); }, 100);
    //fix for each link
    const links = document.querySelectorAll('.sidebar-link');
    for (let i = 0; i < links.length; i++) {
      links[i].addEventListener("click", (e) => {
        setTimeout(() => {  window.scroll(0, 0); }, 0.01);
      });
    }
</script>
